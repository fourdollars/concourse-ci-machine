name: concourse-ci-machine
display-name: Concourse CI
summary: A Juju charm for Concourse CI deployment and management
description: |
  This charm provides automated deployment, configuration, and lifecycle management
  of Concourse CI on Juju infrastructure. Features include PostgreSQL 16+ integration
  with Juju secrets support, dynamic port configuration with privileged port support,
  automatic external-URL detection, and systemd-based service management with operational
  actions for common tasks. Optimized for Ubuntu 24.04 LTS.

tags:
  - ci-cd
  - automation
  - devops

provides:
  # For potential subordinate charms (monitoring, logging, etc.)
  monitoring:
    interface: monitoring
  
  # TSA (web) provides connection info to workers
  web-tsa:
    interface: concourse-tsa

requires:
  postgresql:
    interface: postgresql_client
    limit: 1
    description: PostgreSQL 16+ database backend for Concourse (uses Juju secrets for credentials)
  
  # Worker connects to TSA (web)
  worker-tsa:
    interface: concourse-tsa

peers:
  concourse-peer:
    interface: concourse-peer

storage:
  concourse-data:
    type: filesystem
    location: /var/lib/concourse
